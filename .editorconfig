root = true

[*]
indent_style = space
indent_size = 4
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.{cs,csx}]
# .NET naming conventions
dotnet_naming_rule.private_fields_underscore.symbols = private_fields
dotnet_naming_rule.private_fields_underscore.style = underscore_prefix
dotnet_naming_rule.private_fields_underscore.severity = suggestion

dotnet_naming_symbols.private_fields.applicable_kinds = field
dotnet_naming_symbols.private_fields.applicable_accessibilities = private

dotnet_naming_style.underscore_prefix.capitalization = camel_case
dotnet_naming_style.underscore_prefix.required_prefix = _

# Code style
csharp_style_var_for_built_in_types = true:suggestion
csharp_style_var_when_type_is_apparent = true:suggestion
csharp_prefer_braces = when_multiline:suggestion

# =============================================================================
# Analyzer Configuration
# =============================================================================

# --- Suppressions (rules disabled for this project) ---
dotnet_diagnostic.CA1305.severity = none   # IFormatProvider - too noisy for internal formatters
dotnet_diagnostic.CA1707.severity = none   # Underscores in identifiers - conflicts with test naming
dotnet_diagnostic.RCS1194.severity = none  # Exception constructors - not needed for internal exceptions

# --- Meziantou.Analyzer Configuration ---
# Suppressions (too noisy or not applicable)
dotnet_diagnostic.MA0011.severity = none   # IFormatProvider - same as CA1305, too noisy for formatters
dotnet_diagnostic.MA0048.severity = none   # File name must match type name - covered by RCS1060
dotnet_diagnostic.MA0051.severity = suggestion  # Method too long - style preference

# Demoted to suggestion (valid but would require large refactor)
dotnet_diagnostic.MA0002.severity = suggestion  # IEqualityComparer - gradual adoption
dotnet_diagnostic.MA0016.severity = suggestion  # Collection abstraction - DTOs need concrete types for serialization
dotnet_diagnostic.MA0015.severity = suggestion  # ArgumentException with param name - refactor later

dotnet_diagnostic.MA0046.severity = suggestion  # Delegate parameter count - progress delegates are 1-param by design
dotnet_diagnostic.MA0049.severity = suggestion  # Type name vs namespace - DependencyGraph namespace is intentional
dotnet_diagnostic.MA0140.severity = suggestion  # Identical if/else branches - intentional for clarity

# Keep as warning (high value, catch real bugs)
dotnet_diagnostic.MA0004.severity = warning     # ConfigureAwait(false) in library code
dotnet_diagnostic.MA0006.severity = warning     # String.Equals instead of ==
dotnet_diagnostic.MA0023.severity = warning     # RegexOptions.ExplicitCapture - prevents accidental captures

# --- Demoted to suggestion (valid but not enforced) ---
dotnet_diagnostic.CA1822.severity = suggestion  # Mark members as static
dotnet_diagnostic.CA1848.severity = suggestion  # Use LoggerMessage delegates
dotnet_diagnostic.CA1859.severity = suggestion  # Use concrete types
dotnet_diagnostic.CA1863.severity = suggestion  # Use CompositeFormat
dotnet_diagnostic.CA1866.severity = suggestion  # Use char overload
dotnet_diagnostic.CA1869.severity = suggestion  # Cache JsonSerializerOptions
dotnet_diagnostic.RCS1075.severity = suggestion # Empty catch clause - valid for cleanup patterns

# --- Enforced rules ---
dotnet_diagnostic.RCS1060.severity = warning    # One type per file

# =============================================================================
# CLI Application Relaxations
# =============================================================================
[src/DraftSpec.Cli/**/*.cs]

# ConfigureAwait not critical for CLI app (no SynchronizationContext to preserve)
dotnet_diagnostic.MA0004.severity = suggestion

# =============================================================================
# Test Project Relaxations
# =============================================================================
[{tests,examples,benchmarks}/**/*.cs]

# --- Suppressions (not applicable to tests) ---
dotnet_diagnostic.CA1051.severity = none  # Visible instance fields - ok in test helpers
dotnet_diagnostic.CA1304.severity = none  # Specify culture
dotnet_diagnostic.CA1310.severity = none  # Specify StringComparison
dotnet_diagnostic.CA1311.severity = none  # Specify culture
dotnet_diagnostic.CA1711.severity = none  # Incorrect suffix - test naming freedom
dotnet_diagnostic.CA1852.severity = none  # Types can be sealed
dotnet_diagnostic.CA2201.severity = none  # Generic exceptions - ok for test setup
dotnet_diagnostic.MA0004.severity = none  # ConfigureAwait - tests don't have SynchronizationContext
dotnet_diagnostic.MA0006.severity = none  # string.Equals - test code uses == for readability
dotnet_diagnostic.MA0009.severity = none  # Regex DoS - test patterns are trusted input
dotnet_diagnostic.MA0061.severity = none  # Method override default values - test mock overrides
dotnet_diagnostic.MA0074.severity = none  # StringComparison overload - test assertions use simple form

# --- Demoted to suggestion ---
dotnet_diagnostic.CA1001.severity = suggestion  # Disposable fields
dotnet_diagnostic.CA1806.severity = suggestion  # Ignore method results
dotnet_diagnostic.CA1816.severity = suggestion  # GC.SuppressFinalize
dotnet_diagnostic.CA1861.severity = suggestion  # Constant arrays - ok in test data

[*.{json,yml,yaml}]
indent_size = 2

[*.md]
trim_trailing_whitespace = false

[Makefile]
indent_style = tab
