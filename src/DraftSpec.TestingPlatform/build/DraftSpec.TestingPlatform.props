<?xml version="1.0" encoding="utf-8"?>
<Project>
  <PropertyGroup>
    <!-- Mark this as a test project for MTP -->
    <IsTestProject>true</IsTestProject>

    <!-- Enable Microsoft.Testing.Platform -->
    <EnableMicrosoftTestingPlatform Condition="'$(EnableMicrosoftTestingPlatform)' == ''">true</EnableMicrosoftTestingPlatform>

    <!-- Mark as MTP application for dotnet test recognition -->
    <IsTestingPlatformApplication>true</IsTestingPlatformApplication>

    <!-- Enable Testing Platform protocol for IDE communication -->
    <TestingPlatformDotnetTestSupport>true</TestingPlatformDotnetTestSupport>
    <UseTestingPlatformProtocol>true</UseTestingPlatformProtocol>
    <IsTestingPlatformEnabled>true</IsTestingPlatformEnabled>

    <!-- Disable MS's entry point generation - DraftSpec generates its own -->
    <GenerateMicrosoftTestingPlatformEntryPoint>false</GenerateMicrosoftTestingPlatformEntryPoint>

    <!-- Generate DraftSpec's custom entry point -->
    <GenerateDraftSpecEntryPoint Condition="'$(GenerateDraftSpecEntryPoint)' == ''">true</GenerateDraftSpecEntryPoint>

    <!-- Output as executable for dotnet test -->
    <OutputType>Exe</OutputType>

    <!-- Enable reflection for JSON serialization (required for DraftSpec) -->
    <JsonSerializerIsReflectionEnabledByDefault>true</JsonSerializerIsReflectionEnabledByDefault>
  </PropertyGroup>

  <!-- Add TestContainer capability for IDE Test Explorer discovery -->
  <ItemGroup>
    <ProjectCapability Include="TestContainer" />
  </ItemGroup>

  <!-- Default spec file pattern -->
  <PropertyGroup Condition="'$(DraftSpecPattern)' == ''">
    <DraftSpecPattern>**/*.spec.csx</DraftSpecPattern>
  </PropertyGroup>
</Project>
